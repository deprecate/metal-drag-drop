# metal-drag-drop

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

## Drag

**Extends State**

Responsible for making elements draggable. Handles all the logic
for dragging elements. Dropping is handled by `DragDrop`.

**Parameters**

-   `config`

### activeDragPlaceholder\_

The drag placeholder that is active at the moment.

### activeDragSource\_

The drag source that is active at the moment.

### distanceDragged\_

The distance that has been dragged.

### dragging\_

Flag indicating if one of the sources are being dragged.

### dragHandler\_

The `EventHandler` instance that holds events that keep track of the drag action.

### dragScrollDelta\_

`DragScrollDelta` instance.

### mousePos\_

The current x and y positions of the mouse (or null if not dragging).

### mouseSourceDelta\_

The distance between the mouse position and the dragged source position
(or null if not dragging).

### sourceHandler\_

The `EventHandler` instance that holds events for the source (or sources).

### sourceRegion\_

The current region values of the element being dragged, relative to
the document (or null if not dragging).

### sourceRelativePos\_

The current x and y positions of the element being dragged relative to its
`offsetParent`, or to the viewport if there's no `offsetParent`
(or null if not dragging).

### attachSourceEvents\_

Attaches the necessary events to the source (or sources).

### buildEventObject\_

Builds the object with data to be passed to a drag event.

Returns **![Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)**

### calculateEndPosition\_

Calculates the end positions for the drag action when
`cloneContainer` is set.

Returns **![Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)**

### calculateInitialPosition\_

Calculates the initial positions for the drag action.

**Parameters**

-   `event` **![Event](https://developer.mozilla.org/en-US/docs/Web/API/Event)**

### calculateRelativePosition\_

Calculates the relative position of the active drag
source.

Returns **![Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)**

### canStartDrag\_

Checks if the given event can start a drag operation.

**Parameters**

-   `event` **![Event](https://developer.mozilla.org/en-US/docs/Web/API/Event)**

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)**

### cleanUpAfterDragging\_

Resets all variables to their initial values and detaches drag listeners.

### cloneActiveDrag\_

Clones the active drag source and adds the clone to the document.

Returns **![Element](https://developer.mozilla.org/en-US/docs/Web/API/Element)**

### constrain\_

Constrains the given region according to the current state configuration.

**Parameters**

-   `region` **![Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)**

### constrainToAxis\_

Constrains the given region according to the chosen drag axis, if any.

**Parameters**

-   `region` **![Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)**

### constrainToRegion\_

Constrains the given region within the region defined by the `constrain` state.

**Parameters**

-   `region` **![Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)**

### constrainToSteps\_

Constrains the given region to change according to the `steps` state.

**Parameters**

-   `region` **![Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)**

### createActiveDragPlaceholder\_

Creates the active drag placeholder, unless it already exists.

### defaultDragFn\_

The default behavior for the `Drag.Events.DRAG` event. Can be prevented
by calling the `preventDefault` function on the event's facade. Moves
the placeholder to the new calculated source position.

### defaultEndFn\_

The default behavior for the `Drag.Events.END` event. Can be prevented
by calling the `preventDefault` function on the event's facade. Moves
the source element to the final calculated position.

### disposeInternal

### getActiveDrag

Gets the active drag source.

Returns **[Element](https://developer.mozilla.org/en-US/docs/Web/API/Element)**

### handleDragEndEvent\_

Handles events that can end a drag action, like "mouseup" and "touchend".
Triggered when the mouse drag action ends.

### handleDragMoveEvent\_

Handles events that can move a draggable element, like "mousemove" and "touchmove".
Tracks the movement on the screen to update the drag action.

**Parameters**

-   `event` **![Event](https://developer.mozilla.org/en-US/docs/Web/API/Event)**

### handleDragStartEvent\_

Handles events that can start a drag action, like "mousedown" and "touchstart".
When this is triggered and the sources were not already being dragged, more
listeners will be attached to keep track of the drag action.

**Parameters**

-   `event` **![Event](https://developer.mozilla.org/en-US/docs/Web/API/Event)**

### handleKeyDown\_

Handles a `keydown` event on the document. Ends the drag if ESC was the pressed key.

**Parameters**

-   `event` **![Event](https://developer.mozilla.org/en-US/docs/Web/API/Event)**

### handleScrollDelta\_

Handles a "scrollDelta" event. Updates the position data for the source,
as well as the placeholder's position on the screen when "move" is set to true.

**Parameters**

-   `event` **![Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)**

### handleSourceKeyDown\_

Handles a `keydown` event from `KeyboardDrag`. Does the appropriate drag action
for the pressed key.

**Parameters**

-   `event` **![Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)**

### handleContainerChanged\_

Triggers when the `container` state changes. Detaches events attached to the
previous container and attaches them to the new value instead.

### handleSourcesChanged\_

Triggers when the `sources` state changes. Detaches events attached to the
previous sources and attaches them to the new value instead.

### hasReachedMinimumDistance\_

Checks if the minimum distance for dragging has been reached after
adding the given values.

**Parameters**

-   `distanceX` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)**
-   `distanceY` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)**

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)**

### isDragging

Checks if one of the sources are being dragged.

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)**

### isPlaceholderClone\_

Returns true if current drag placeholder is a clone of the original drag
source.

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)**

### isWithinHandle\_

Checks if the given element is within a valid handle.

**Parameters**

-   `element` **![Element](https://developer.mozilla.org/en-US/docs/Web/API/Element)**

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)**

### moveToPosition\_

Moves the given element to the current source coordinates.

**Parameters**

-   `element` **![Element](https://developer.mozilla.org/en-US/docs/Web/API/Element)**

### setterAutoScrollFn\_

Setter for the `autoScroll` state key.

**Parameters**

-   `val` **any**

Returns **![DragAutoScroll](#dragautoscroll)**

### setterConstrainFn

Setter for the `constrain` state key.

**Parameters**

-   `val` **(![Element](https://developer.mozilla.org/en-US/docs/Web/API/Element) \| [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object) \| [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String))**

Returns **(![Element](https://developer.mozilla.org/en-US/docs/Web/API/Element) \| [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object))**

### setterScrollContainersFn\_

Sets the `scrollContainers` state key.

**Parameters**

-   `val` **([Element](https://developer.mozilla.org/en-US/docs/Web/API/Element) \| [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String))**

Returns **![Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;![Element](https://developer.mozilla.org/en-US/docs/Web/API/Element)>**

### startDragging\_

Starts dragging the selected source.

**Parameters**

-   `event` **![Event](https://developer.mozilla.org/en-US/docs/Web/API/Event)**

### toElements\_

Converts the given element or selector into an array of elements.

**Parameters**

-   `elementOrSelector` **([Element](https://developer.mozilla.org/en-US/docs/Web/API/Element) \| [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String))**

Returns **![Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;![Element](https://developer.mozilla.org/en-US/docs/Web/API/Element)>**

### updatePosition

Updates the dragged element's position using the given calculated region.

**Parameters**

-   `newRegion` **![Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)**

### updatePositionFromDelta

Updates the dragged element's position, moving its placeholder if `move`
is set to true.

**Parameters**

-   `deltaX` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)**
-   `deltaY` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)**

### updatePositionFromMouse

Updates the dragged element's position, according to the current mouse position.

### validateElementOrString\_

Validates the given value, making sure that it's either an element or a string.

**Parameters**

-   `val` **any**

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)**

### validateCloneContainer\_

Validates the given value, making sure that it's either an element,
string, or null.

**Parameters**

-   `val` **any**

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)**

### validatorConstrainFn

Validates the value of the `constrain` state.

**Parameters**

-   `val` **any**

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)**

### STATE

State definition.

#### autoScroll

Configuration object for the `DragAutoScroll` instance that will be used for
automatically scrolling the elements in `scrollContainers` during drag when
the mouse is near their boundaries. If set to `false`, auto scrolling will be
disabled (default).

#### axis

The axis that allows dragging. Can be set to just x, just y or both (default).

#### cloneContainer

Container element for cloned drag placeholder. Only applies if
`dragPlaceholder` is set to `Drag.Placeholder.CLONE`.

#### constrain

Object with the boundaries, that the dragged element should not leave
while being dragged. If not set, the element is free to be dragged
to anywhere on the page. Can be either already an object with the
boundaries relative to the document, or an element to use the boundaries
from, or even a selector for finding that element.

#### container

An element that contains all sources, targets and scroll containers. This
will be used when delegate events are attached or when looking for elements
by selector. Defaults to `document`.

#### disabled

Flag indicating if drag operations are disabled. When set to true, it
dragging won't work.

#### draggingClass

The CSS class that should be added to the node being dragged.

#### dragPlaceholder

The placeholder element that should be moved during drag. Can be either
an element or the "clone" string, indicating that a clone of the source
being dragged should be used. If nothing is set, the original source element
will be used.

#### handles

Elements inside the source that should be the drag handles. Can be
either a single element or a selector for multiple elements.

#### keyboardSpeed

The number of pixels that the source should move when dragged via
the keyboard controls.

#### minimumDragDistance

The minimum distance, in pixels, that the mouse needs to move before
the action is considered a drag.

#### scrollContainers

Elements with scroll, besides the document, that contain any of the given
sources. Can be either a single element or a selector for multiple elements.

#### sources

Elements that should be draggable. Can be either a single element
or a selector for multiple elements.

#### steps

The number of pixels that the source element should move at a time,
for each axis. When set to a value higher than 1, dragging won't be
a continuous movement, since the source element will move by multiple
pixels on each step.

#### useShim

Flag indicating if a shim should be used for capturing document events.
This is important for allowing dragging nodes over iframes. If false,
events will be listened in the document itself instead.

### Events

Holds the names of events that can be emitted by `Drag`.

### Placeholder

Holds the values that can be passed to the `dragPlaceholder` state key.

## DragDrop

**Extends Drag**

Adds the functionality of dropping dragged elements to specific
targets to the `Drag` class.

**Parameters**

-   `config`

### activeTargets\_

The currently active targets, that is, the ones that the dragged source is over.

### addTarget

Adds a target to this `DragDrop` instance.

**Parameters**

-   `target` **![Element](https://developer.mozilla.org/en-US/docs/Web/API/Element)**

### buildEventObject\_

Overrides the original method from `Drag` to include the target on the event object.

Returns **![Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)**

### cleanUpAfterDragging\_

### findAllActiveTargets\_

Finds all targets that the dragged element is currently over.

Returns **![Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;![Element](https://developer.mozilla.org/en-US/docs/Web/API/Element)>** The current active targets.

### getSourceRegion\_

Gets the active source's region, to be used when calculating which targets are active.

Returns **![Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)**

### handleContainerChanged\_

Triggers when the `container` state changes. Overrides default method so
it will also update `targets` when container changes.

**Parameters**

-   `data` **![Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)**
-   `event` **![Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)**

### removeTarget

Removes a target from this `DragDrop` instance.

**Parameters**

-   `target` **![Element](https://developer.mozilla.org/en-US/docs/Web/API/Element)**

### setterTargetsFn\_

Sets the `targets` state property.

**Parameters**

-   `val` **([Element](https://developer.mozilla.org/en-US/docs/Web/API/Element) \| [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String))**

Returns **![Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;![Element](https://developer.mozilla.org/en-US/docs/Web/API/Element)>**

### startDragging\_

Overrides the original method from `Drag` to also set the "aria-dropeffect"
attribute, if set, for all targets.

### updatePosition

Overrides original method from `Drag` to also be enable finding the target
the dragged element is over at the new position.

**Parameters**

-   `deltaX` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)**
-   `deltaY` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)**

### STATE

State definition.

#### ariaDropEffect

The "aria-dropeffect" value to be set for all targets. If not set,
this html attribute will have to be set manually on the targets.

#### targetOverClass

The CSS class that should be added to drop targets when a source
is being dragged over them.

#### targets

Elements that the sources can be dropped on. Can be either a single
element or a selector for multiple elements.

### Events

Holds the names of events that can be emitted by `DragDrop`.

## DragAutoScroll

**Extends State**

Helper called by the `Drag` instance that scrolls elements when the
mouse is near their boundaries.

**Parameters**

-   `config`

### scrollTimeout\_

The handler for the current call to `setTimeout`.

### disposeInternal

### getRegionWithoutScroll\_

Gets the region for the given scroll container, without including scroll.

**Parameters**

-   `scrollContainer` **![Element](https://developer.mozilla.org/en-US/docs/Web/API/Element)**

Returns **![Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)**

### scroll

Schedules a function to scroll the given containers.

**Parameters**

-   `scrollContainers` **![Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;![Element](https://developer.mozilla.org/en-US/docs/Web/API/Element)>**
-   `mouseX` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)**
-   `mouseY` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)**

### scrollElement\_

Adds the given deltas to the given element's scroll position.

**Parameters**

-   `element` **![Element](https://developer.mozilla.org/en-US/docs/Web/API/Element)**
-   `deltaX` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)**
-   `deltaY` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)**

### scrollInternal\_

Scrolls the given containers if the mouse is near their boundaries.

**Parameters**

-   `scrollContainers` **![Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;![Element](https://developer.mozilla.org/en-US/docs/Web/API/Element)>**
-   `mouseX` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)**
-   `mouseY` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)**

### stop

Stops any auto scrolling that was scheduled to happen in the future.

### STATE

State definition.

#### delay

The delay in ms before an element is scrolled automatically.

#### maxDistance

The maximum distance the mouse needs to be from an element before
it will be scrolled automatically.

#### speed

The number of pixels that will be scrolled each time.

## DragScrollDelta

**Extends EventEmitter**

Helper called by the `Drag` instance that emits an event whenever
the scroll position of the given containers change.

### handler\_

`EventHandler` for the scroll events.

### scrollPositions\_

The scroll positions for the scroll elements that are being listened to.

### disposeInternal

### handleScroll\_

Handles a "scroll" event, emitting a "scrollDelta" event with the
difference between the previous and new values.

**Parameters**

-   `index` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)**
-   `event` **![Event](https://developer.mozilla.org/en-US/docs/Web/API/Event)**

### start

Starts listening to scroll changes on the given elements that contain
the current drag node.

**Parameters**

-   `dragNode` **![Element](https://developer.mozilla.org/en-US/docs/Web/API/Element)**
-   `scrollContainers` **![Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;![Element](https://developer.mozilla.org/en-US/docs/Web/API/Element)>**

### stop

Stops listening to scroll changes.

## DragShim

Helper called by the `Drag` instance that creates a shim element
for attaching event listeners instead of attaching them to the
document. Helpful when dragging over iframes.

### attachDocListeners

Attaches a listener for the document. If `useShim` is true, a
shim element covering the whole document will be created and
the listener will be attached to it instead.

**Parameters**

-   `useShim` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)**
-   `listeners` **![Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String), !function ()>**

Returns **![Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;!EventHandle>**

### getDocShim

Gets the document's shim element, creating it when called for the first time.

Returns **![Element](https://developer.mozilla.org/en-US/docs/Web/API/Element)**

### hideDocShim

Hides the document's shim element.

### reset

Resets `DragShim`, removing the shim element from the document
and clearing its variable so it can be created again.

### docShim\_

The shim element. This is only created when necessary.
